<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>TRS Admin Panel</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  background:#020408;
  color:#e6eaf2;
  font-family:Segoe UI,Roboto,sans-serif;
  padding:20px;
}

h1{
  text-align:center;
  color:#e6eaf2;
  letter-spacing:2px;
  margin-bottom:20px;
}

.panel{
  max-width:520px;
  margin:auto;
  background:rgba(20,25,40,.85);
  padding:24px;
  border-radius:18px;
  box-shadow:0 0 40px rgba(0,0,0,.8);
  border:1px solid rgba(255,255,255,.06);
}

input{
  width:100%;
  margin-top:12px;
  padding:14px;
  border-radius:12px;
  border:1px solid rgba(255,255,255,.08);
  background:#0b1020;
  color:#fff;
  font-size:15px;
}

input::placeholder{
  color:#7c8399;
}

button{
  width:100%;
  margin-top:16px;
  padding:14px;
  border-radius:12px;
  border:none;
  background:linear-gradient(135deg,#1c2335,#2a3550);
  color:#fff;
  font-weight:600;
  letter-spacing:1px;
  box-shadow:0 0 15px rgba(0,0,0,.8);
}

button:hover{
  background:linear-gradient(135deg,#232c44,#36456b);
}

.status{
  margin-top:15px;
  font-size:13px;
  color:#b0b7cc;
}
</style>
</head>

<body>

<h1>TRS Admin Control</h1>

<div class="panel">
  <input type="file" id="file">
  <input id="release" placeholder="Release name (e.g. MTN-Daily)">
  <button onclick="upload()">Upload & Publish</button>
  <div class="status" id="status"></div>
</div>

<script>
const OWNER="DARKVENOMRSA";
const REPO="trs-configs";
const WORKFLOW="admin-upload.yml";

async function upload(){
  const file=document.getElementById("file").files[0];
  const release=document.getElementById("release").value.trim();
  const status=document.getElementById("status");

  if(!file || !release){
    status.innerText="Select file and release name";
    return;
  }

  status.innerText="Encoding file…";

  const reader=new FileReader();
  reader.onload=async ()=>{
    const base64=reader.result.split(",")[1];

    status.innerText="Sending to GitHub…";

    const res=await fetch(`https://api.github.com/repos/${OWNER}/${REPO}/actions/workflows/${WORKFLOW}/dispatches`,{
      method:"POST",
      headers:{
        "Accept":"application/vnd.github+json",
        "Content-Type":"application/json"
      },
      body:JSON.stringify({
        ref:"main",
        inputs:{
          filename:file.name,
          content:base64,
          release:release
        }
      })
    });

    if(res.status===204){
      status.innerText="Upload started. GitHub is publishing…";
    }else{
      status.innerText="Error: "+res.status;
    }
  };

  reader.readAsDataURL(file);
}
</script>

</body>
</html>
